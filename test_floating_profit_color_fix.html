<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>浮盈颜色修复测试</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>浮盈颜色修复测试</h2>
        <p class="text-muted">测试复盘记录列表中的浮盈颜色显示：红色代表盈利，绿色代表亏损</p>
        
        <div class="card">
            <div class="card-header">
                <h5>历史交易记录测试</h5>
            </div>
            <div class="card-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>股票代码</th>
                            <th>实际收益</th>
                            <th>收益率</th>
                            <th>状态</th>
                        </tr>
                    </thead>
                    <tbody id="test-table-body">
                        <!-- 测试数据将在这里显示 -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h5>复盘编辑器测试</h5>
            </div>
            <div class="card-body">
                <div class="row" id="trade-info-test">
                    <!-- 交易信息测试将在这里显示 -->
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h5>颜色说明</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>正确的颜色规则：</h6>
                        <ul>
                            <li><span class="text-danger fw-bold">红色</span> - 表示盈利（正数）</li>
                            <li><span class="text-success fw-bold">绿色</span> - 表示亏损（负数）</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>示例：</h6>
                        <p>盈利 <span class="text-danger fw-bold">+¥1,234.56 (+12.34%)</span></p>
                        <p>亏损 <span class="text-success fw-bold">-¥567.89 (-5.67%)</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 模拟测试数据
        const testTrades = [
            { stock_code: '000001', stock_name: '平安银行', total_return: 1234.56, return_rate: 0.1234 },
            { stock_code: '000002', stock_name: '万科A', total_return: -567.89, return_rate: -0.0567 },
            { stock_code: '000858', stock_name: '五粮液', total_return: 2345.67, return_rate: 0.2345 },
            { stock_code: '002415', stock_name: '海康威视', total_return: -890.12, return_rate: -0.0890 },
            { stock_code: '600036', stock_name: '招商银行', total_return: 0, return_rate: 0 }
        ];

        // 格式化数字
        function formatNumber(num) {
            return new Intl.NumberFormat('zh-CN', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(num);
        }

        // 渲染测试表格
        function renderTestTable() {
            const tbody = document.getElementById('test-table-body');
            
            tbody.innerHTML = testTrades.map(trade => `
                <tr>
                    <td>
                        <strong>${trade.stock_code}</strong><br>
                        <small class="text-muted">${trade.stock_name}</small>
                    </td>
                    <td>
                        <span class="${trade.total_return >= 0 ? 'text-danger fw-bold' : 'text-success fw-bold'}">
                            ${trade.total_return >= 0 ? '+' : ''}¥${formatNumber(trade.total_return)}
                        </span>
                    </td>
                    <td>
                        <span class="${trade.return_rate >= 0 ? 'text-danger fw-bold' : 'text-success fw-bold'}">
                            ${trade.return_rate >= 0 ? '+' : ''}${(trade.return_rate * 100).toFixed(2)}%
                        </span>
                    </td>
                    <td>
                        ${trade.total_return > 0 ? 
                            '<span class="badge bg-success">盈利</span>' : 
                            trade.total_return < 0 ? 
                                '<span class="badge bg-danger">亏损</span>' : 
                                '<span class="badge bg-secondary">持平</span>'
                        }
                    </td>
                </tr>
            `).join('');
        }

        // 渲染交易信息测试
        function renderTradeInfoTest() {
            const tradeInfo = document.getElementById('trade-info-test');
            const testTrade = testTrades[0]; // 使用第一个盈利的交易作为示例
            
            tradeInfo.innerHTML = `
                <div class="col-md-3">
                    <strong>股票:</strong> ${testTrade.stock_code} ${testTrade.stock_name}
                </div>
                <div class="col-md-3">
                    <strong>持仓天数:</strong> 15天
                </div>
                <div class="col-md-3">
                    <strong>投入本金:</strong> ¥${formatNumber(10000)}
                </div>
                <div class="col-md-3">
                    <strong>实际收益:</strong> 
                    <span class="${testTrade.total_return >= 0 ? 'text-danger' : 'text-success'}">
                        ¥${formatNumber(testTrade.total_return)} (${(testTrade.return_rate * 100).toFixed(2)}%)
                    </span>
                </div>
            `;
        }

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            renderTestTable();
            renderTradeInfoTest();
            
            console.log('✅ 浮盈颜色修复测试页面加载完成');
            console.log('📋 测试说明：');
            console.log('   - 红色数字表示盈利（正数）');
            console.log('   - 绿色数字表示亏损（负数）');
            console.log('   - 这符合中国股市的颜色习惯');
        });
    </script>
</body>
</html>