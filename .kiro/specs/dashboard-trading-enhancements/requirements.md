# 需求文档

## 介绍

本功能增强交易日志系统，包括改进的仪表板分析、灵活的交易记录管理、更好的止盈目标配置和非交易日支持。这些增强功能专注于提供更准确的财务指标、移除特定股票类型的交易限制、改进交易录入的用户工作流程，以及添加可配置的分析显示。

## 需求

### 需求 1: 仪表板收益指标增强

**用户故事:** 作为交易者，我希望在仪表板上看到已实现和未实现的收益，以便快速评估我的整体交易表现。

#### 验收标准

1. 当仪表板加载时，系统应显示"已清仓收益"，单位为元
2. 当仪表板加载时，系统应显示"当前持仓收益"，单位为元
3. 当计算已清仓收益时，系统应汇总所有已完成的交易（买入-卖出配对）
4. 当计算当前持仓收益时，系统应使用当前市场价格减去所有持仓的成本基础

### 需求 2: 股票数量交易规则增强

**用户故事:** 作为处理科创板股票的交易者，我希望能够购买以"68"开头的股票的任意数量股份，以便按照实际市场规则进行交易。

#### 验收标准

1. 当为以"68"开头的股票代码添加买入交易时，系统应允许任何正整数数量
2. 当为其他股票代码添加买入交易时，系统应保持当前的100股倍数限制
3. 当验证股票数量时，系统应检查股票代码前缀以确定适用规则

### 需求 3: 交易类型选择工作流程

**用户故事:** 作为交易者，我希望从初始交易录入步骤就指定是买入还是卖出，以便系统能够引导我完成适当的工作流程。

#### 验收标准

1. 当点击"添加交易记录"时，系统应提供"买入"或"卖出"选项
2. 当选择"卖出"时，系统应仅显示当前持仓池中的股票
3. 当选择"买入"时，系统应允许输入任何有效的股票代码
4. 当选择交易类型时，系统应在整个交易录入过程中保持此上下文

### 需求 4: 止盈目标配置修复

**用户故事:** 作为设置止盈目标的交易者，我希望系统正确解释百分比值，以便我可以设置超过10%的现实止盈目标和超过100%的卖出比例。

#### 验收标准

1. 当设置非分批止盈目标时，系统应将输入值视为百分比
2. 当验证止盈目标百分比时，系统应允许大于10的值（代表>10%）
3. 当验证卖出比例百分比时，系统应允许大于1的值（代表>100%）
4. 当显示止盈目标时，系统应显示百分比符号（%）以便清晰

### 需求 5: 月度收益率数据修复

**用户故事:** 作为交易者，我希望在仪表板上看到准确的月度收益率，以便跟踪我随时间的表现。

#### 验收标准

1. 当仪表板加载时，系统应计算并显示月度收益率
2. 当计算月度收益时，系统应使用每月的已实现收益和损失
3. 当某月没有交易数据时，系统应显示适当的指示器
4. 当显示月度收益时，系统应显示格式正确的百分比值

### 需求 6: 可配置收益分布分析

**用户故事:** 作为交易者，我希望通过可配置的收益区间分析我的已完成交易，以便了解我的交易表现分布。

#### 验收标准

1. 当查看收益分布时，系统应分析已完成的交易配对（而非单个股票）
2. 当计算收益区间时，系统应将每个买入-卖出周期视为单独的交易
3. 当显示分布时，系统应显示每个收益区间的数量和百分比
4. 当配置收益区间时，系统应允许用户设置自定义区间边界
5. 当一只股票被多次购买时，系统应独立处理每个完整的买入-卖出周期

### 需求 7: 仪表板和复盘页面清理

**用户故事:** 作为交易者，我希望有一个更清洁的界面，没有不必要的模块，以便我可以专注于相关信息。

#### 验收标准

1. 当查看仪表板时，系统不应显示"最近交易"模块
2. 当查看仪表板时，系统不应显示"持仓提醒"模块
3. 当查看复盘页面时，系统不应显示"持仓策略提醒"模块
4. 当移除这些模块时，系统应保持所有其他现有功能

### 需求 8: 非交易日配置和持仓期间计算

**用户故事:** 作为交易者，我希望配置非交易日并看到准确的持仓期间，以便基于市场交易日跟踪实际交易表现。

#### 验收标准

1. 当系统计算持仓天数时，应自动排除所有周六和周日
2. 当配置非交易日时，系统应允许手动添加节假日日期
3. 当计算持仓期间时，系统应仅使用实际交易日
4. 当在复盘分析中查看当前持仓时，系统应显示实际持仓天数
5. 当添加/编辑非交易日时，系统应提供管理界面
6. 当配置非交易日时，系统应将其应用于所有持仓期间计算
7. 当显示持仓天数时，系统应清楚地表明这些仅为交易日