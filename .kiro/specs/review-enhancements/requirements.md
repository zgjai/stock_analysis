# 需求文档

## 介绍

本功能增强现有的复盘功能，添加三个关键能力：支持后端API的可编辑持仓天数、复盘数据保存功能，以及当前价格输入和自动浮盈比例计算。这些增强功能将通过允许更全面的交易分析和复盘模块中的数据持久化来改善用户体验。

## 需求

### 需求 1

**用户故事：** 作为一名交易者，我希望在复盘模块中编辑持仓天数，以便我可以纠正或更新我的交易持续时间信息。

#### 验收标准

1. 当用户点击复盘模块中的持仓天数字段时，系统应使该字段可编辑
2. 当用户修改持仓天数值时，系统应验证输入是正整数
3. 当用户保存修改的持仓天数时，系统应将更新的值发送到后端API
4. 当后端接收到持仓天数更新时，系统应将更改持久化到数据库
5. 如果持仓天数更新失败，系统应显示错误消息并恢复到原始值

### 需求 2

**用户故事：** 作为一名交易者，我希望保存我的复盘分析和笔记，以便我可以保留我的见解并在以后参考它们。

#### 验收标准

1. 当用户在复盘模块中进行更改时，系统应启用保存按钮
2. 当用户点击保存按钮时，系统应收集所有复盘数据，包括笔记、分析和修改
3. 当发送保存请求时，系统应调用后端API来持久化复盘数据
4. 当保存操作成功时，系统应显示成功确认消息
5. 当保存操作失败时，系统应显示带有详细信息的错误消息
6. 如果有未保存的更改，系统应在用户离开复盘页面之前警告用户

### 需求 3

**用户故事：** 作为一名交易者，我希望输入当前价格并看到自动计算的浮盈比例，以便我可以快速评估我的持仓当前表现。

#### 验收标准

1. 当复盘模块加载时，系统应显示当前价格输入字段
2. 当用户输入当前价格时，系统应验证输入是正数
3. 当输入有效的当前价格时，系统应自动计算浮盈比例
4. 当计算浮盈比例时，系统应以适当格式显示百分比结果
5. 当当前价格变化时，系统应实时重新计算并更新浮盈比例
6. 如果原始购买价格不可用，系统应显示适当的消息，指示无法计算
7. 当浮盈比例为正时，系统应以绿色显示
8. 当浮盈比例为负时，系统应以红色显示