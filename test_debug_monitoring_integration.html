<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è°ƒè¯•ç›‘æ§ç³»ç»Ÿé›†æˆæµ‹è¯•</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
        }
        .test-result.success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .test-result.error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .test-result.warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        .console-output {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .btn-test {
            margin: 5px;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-indicator.success { background-color: #28a745; }
        .status-indicator.error { background-color: #dc3545; }
        .status-indicator.warning { background-color: #ffc107; }
        .status-indicator.info { background-color: #17a2b8; }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="row">
            <div class="col-12">
                <h1 class="text-center mb-4">
                    <i class="fas fa-bug"></i> è°ƒè¯•ç›‘æ§ç³»ç»Ÿé›†æˆæµ‹è¯•
                </h1>
                <p class="text-center text-muted">æµ‹è¯•ä»»åŠ¡10ï¼šæ·»åŠ é”™è¯¯ç›‘æ§å’Œè°ƒè¯•æ”¯æŒ</p>
            </div>
        </div>

        <!-- ç³»ç»ŸçŠ¶æ€æ¦‚è§ˆ -->
        <div class="test-section">
            <h3><i class="fas fa-tachometer-alt"></i> ç³»ç»ŸçŠ¶æ€æ¦‚è§ˆ</h3>
            <div id="system-status" class="row">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title">è°ƒè¯•ç³»ç»Ÿ</h5>
                            <p class="card-text" id="debug-system-status">
                                <span class="status-indicator info"></span>æ£€æŸ¥ä¸­...
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title">ä¾èµ–çŠ¶æ€</h5>
                            <p class="card-text" id="dependencies-status">
                                <span class="status-indicator info"></span>æ£€æŸ¥ä¸­...
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title">é”™è¯¯è®¡æ•°</h5>
                            <p class="card-text" id="error-count">
                                <span class="status-indicator success"></span>0
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title">æ€§èƒ½çŠ¶æ€</h5>
                            <p class="card-text" id="performance-status">
                                <span class="status-indicator info"></span>ç›‘æ§ä¸­...
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æµ‹è¯•æ§åˆ¶é¢æ¿ -->
        <div class="test-section">
            <h3><i class="fas fa-play-circle"></i> æµ‹è¯•æ§åˆ¶é¢æ¿</h3>
            <div class="row">
                <div class="col-md-6">
                    <h5>åŸºç¡€åŠŸèƒ½æµ‹è¯•</h5>
                    <button class="btn btn-primary btn-test" onclick="testDebugSystemInitialization()">
                        <i class="fas fa-cog"></i> æµ‹è¯•è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–
                    </button>
                    <button class="btn btn-info btn-test" onclick="testDependencyCheck()">
                        <i class="fas fa-check-circle"></i> æµ‹è¯•ä¾èµ–æ£€æŸ¥
                    </button>
                    <button class="btn btn-success btn-test" onclick="testFunctionalTests()">
                        <i class="fas fa-flask"></i> è¿è¡ŒåŠŸèƒ½æµ‹è¯•
                    </button>
                    <button class="btn btn-warning btn-test" onclick="testErrorHandling()">
                        <i class="fas fa-exclamation-triangle"></i> æµ‹è¯•é”™è¯¯å¤„ç†
                    </button>
                </div>
                <div class="col-md-6">
                    <h5>é«˜çº§åŠŸèƒ½æµ‹è¯•</h5>
                    <button class="btn btn-secondary btn-test" onclick="testPerformanceMonitoring()">
                        <i class="fas fa-chart-line"></i> æµ‹è¯•æ€§èƒ½ç›‘æ§
                    </button>
                    <button class="btn btn-dark btn-test" onclick="testLogExport()">
                        <i class="fas fa-download"></i> æµ‹è¯•æ—¥å¿—å¯¼å‡º
                    </button>
                    <button class="btn btn-outline-primary btn-test" onclick="testHealthCheck()">
                        <i class="fas fa-heartbeat"></i> æ‰§è¡Œå¥åº·æ£€æŸ¥
                    </button>
                    <button class="btn btn-outline-danger btn-test" onclick="simulateError()">
                        <i class="fas fa-bomb"></i> æ¨¡æ‹Ÿé”™è¯¯
                    </button>
                </div>
            </div>
        </div>

        <!-- æµ‹è¯•ç»“æœæ˜¾ç¤º -->
        <div class="test-section">
            <h3><i class="fas fa-clipboard-list"></i> æµ‹è¯•ç»“æœ</h3>
            <div id="test-results"></div>
        </div>

        <!-- æ§åˆ¶å°è¾“å‡º -->
        <div class="test-section">
            <h3><i class="fas fa-terminal"></i> æ§åˆ¶å°è¾“å‡º</h3>
            <div class="console-output" id="console-output"></div>
            <div class="mt-2">
                <button class="btn btn-sm btn-outline-secondary" onclick="clearConsoleOutput()">
                    <i class="fas fa-trash"></i> æ¸…ç©ºè¾“å‡º
                </button>
                <button class="btn btn-sm btn-outline-primary" onclick="exportConsoleOutput()">
                    <i class="fas fa-download"></i> å¯¼å‡ºæ—¥å¿—
                </button>
            </div>
        </div>

        <!-- è°ƒè¯•å·¥å…·é¢æ¿ -->
        <div class="test-section">
            <h3><i class="fas fa-tools"></i> è°ƒè¯•å·¥å…·é¢æ¿</h3>
            <div class="row">
                <div class="col-md-4">
                    <h5>ç³»ç»Ÿè¯Šæ–­</h5>
                    <button class="btn btn-outline-info btn-sm w-100 mb-2" onclick="showSystemStatus()">
                        ç³»ç»ŸçŠ¶æ€æŠ¥å‘Š
                    </button>
                    <button class="btn btn-outline-success btn-sm w-100 mb-2" onclick="showDependencyReport()">
                        ä¾èµ–çŠ¶æ€æŠ¥å‘Š
                    </button>
                    <button class="btn btn-outline-warning btn-sm w-100 mb-2" onclick="showErrorReport()">
                        é”™è¯¯æŠ¥å‘Š
                    </button>
                </div>
                <div class="col-md-4">
                    <h5>æ€§èƒ½åˆ†æ</h5>
                    <button class="btn btn-outline-primary btn-sm w-100 mb-2" onclick="showPerformanceReport()">
                        æ€§èƒ½æŠ¥å‘Š
                    </button>
                    <button class="btn btn-outline-secondary btn-sm w-100 mb-2" onclick="measurePageMetrics()">
                        é¡µé¢æ€§èƒ½æŒ‡æ ‡
                    </button>
                    <button class="btn btn-outline-dark btn-sm w-100 mb-2" onclick="optimizePerformance()">
                        æ‰§è¡Œæ€§èƒ½ä¼˜åŒ–
                    </button>
                </div>
                <div class="col-md-4">
                    <h5>ç»´æŠ¤å·¥å…·</h5>
                    <button class="btn btn-outline-danger btn-sm w-100 mb-2" onclick="clearDebugCache()">
                        æ¸…ç†è°ƒè¯•ç¼“å­˜
                    </button>
                    <button class="btn btn-outline-warning btn-sm w-100 mb-2" onclick="resetDebugState()">
                        é‡ç½®è°ƒè¯•çŠ¶æ€
                    </button>
                    <button class="btn btn-outline-info btn-sm w-100 mb-2" onclick="exportAllLogs()">
                        å¯¼å‡ºæ‰€æœ‰æ—¥å¿—
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½å¿…è¦çš„è„šæœ¬ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- æ¨¡æ‹Ÿä¾èµ–è„šæœ¬ -->
    <script>
        // æ¨¡æ‹Ÿç»Ÿä¸€æ¶ˆæ¯ç³»ç»Ÿ
        function showErrorMessage(message, options = {}) {
            console.error('ğŸš¨ é”™è¯¯:', message);
            addToConsole('ERROR', message);
            updateErrorCount();
        }
        
        function showSuccessMessage(message, options = {}) {
            console.log('âœ… æˆåŠŸ:', message);
            addToConsole('SUCCESS', message);
        }
        
        function showWarningMessage(message, options = {}) {
            console.warn('âš ï¸ è­¦å‘Š:', message);
            addToConsole('WARNING', message);
        }
        
        function showInfoMessage(message, options = {}) {
            console.info('â„¹ï¸ ä¿¡æ¯:', message);
            addToConsole('INFO', message);
        }
        
        // æ¨¡æ‹ŸAPIå®¢æˆ·ç«¯
        class ApiClient {
            constructor() {
                this.baseURL = '/api';
            }
            
            async get(url) {
                return { data: 'mock data' };
            }
            
            async post(url, data) {
                return { success: true };
            }
            
            async put(url, data) {
                return { success: true };
            }
            
            async delete(url) {
                return { success: true };
            }
        }
        
        // æ¨¡æ‹Ÿä¿å­˜ç®¡ç†å™¨
        class ReviewSaveManager {
            constructor(formSelector) {
                this.formSelector = formSelector;
                this.hasUnsavedChanges = () => false;
            }
            
            saveReview() {
                console.log('ğŸ“ æ¨¡æ‹Ÿä¿å­˜å¤ç›˜');
                return Promise.resolve({ success: true });
            }
        }
        
        // æ¨¡æ‹Ÿå·¥å…·å‡½æ•°
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }
    </script>
    
    <!-- åŠ è½½è°ƒè¯•ç›‘æ§ç³»ç»Ÿ -->
    <script src="static/js/debug-monitoring.js"></script>
    
    <script>
        // æµ‹è¯•çŠ¶æ€
        let testResults = [];
        let errorCount = 0;
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ è°ƒè¯•ç›‘æ§ç³»ç»Ÿæµ‹è¯•é¡µé¢åˆå§‹åŒ–');
            
            // ç­‰å¾…è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–
            setTimeout(() => {
                updateSystemStatus();
                runInitialTests();
            }, 1000);
        });
        
        // æ›´æ–°ç³»ç»ŸçŠ¶æ€æ˜¾ç¤º
        function updateSystemStatus() {
            // æ£€æŸ¥è°ƒè¯•ç³»ç»ŸçŠ¶æ€
            const debugSystemStatus = document.getElementById('debug-system-status');
            if (typeof debugMonitor !== 'undefined' && debugMonitor) {
                debugSystemStatus.innerHTML = '<span class="status-indicator success"></span>å·²åˆå§‹åŒ–';
            } else {
                debugSystemStatus.innerHTML = '<span class="status-indicator error"></span>æœªåˆå§‹åŒ–';
            }
            
            // æ£€æŸ¥ä¾èµ–çŠ¶æ€
            const dependenciesStatus = document.getElementById('dependencies-status');
            if (typeof debugTools !== 'undefined') {
                const deps = debugTools.checkDependencies();
                const missing = deps.summary.missing;
                if (missing === 0) {
                    dependenciesStatus.innerHTML = '<span class="status-indicator success"></span>å®Œæ•´';
                } else {
                    dependenciesStatus.innerHTML = `<span class="status-indicator warning"></span>ç¼ºå¤±${missing}ä¸ª`;
                }
            } else {
                dependenciesStatus.innerHTML = '<span class="status-indicator error"></span>æ— æ³•æ£€æŸ¥';
            }
            
            // æ›´æ–°é”™è¯¯è®¡æ•°
            updateErrorCount();
            
            // æ£€æŸ¥æ€§èƒ½çŠ¶æ€
            const performanceStatus = document.getElementById('performance-status');
            if ('performance' in window) {
                const loadTime = performance.now();
                if (loadTime < 1000) {
                    performanceStatus.innerHTML = '<span class="status-indicator success"></span>è‰¯å¥½';
                } else if (loadTime < 3000) {
                    performanceStatus.innerHTML = '<span class="status-indicator warning"></span>ä¸€èˆ¬';
                } else {
                    performanceStatus.innerHTML = '<span class="status-indicator error"></span>è¾ƒæ…¢';
                }
            } else {
                performanceStatus.innerHTML = '<span class="status-indicator info"></span>ä¸æ”¯æŒ';
            }
        }
        
        // æ›´æ–°é”™è¯¯è®¡æ•°
        function updateErrorCount() {
            const errorCountElement = document.getElementById('error-count');
            if (typeof debugMonitor !== 'undefined' && debugMonitor) {
                const count = debugMonitor.state.errorCount;
                const indicator = count === 0 ? 'success' : (count < 5 ? 'warning' : 'error');
                errorCountElement.innerHTML = `<span class="status-indicator ${indicator}"></span>${count}`;
            } else {
                errorCountElement.innerHTML = `<span class="status-indicator info"></span>${errorCount}`;
            }
        }
        
        // è¿è¡Œåˆå§‹æµ‹è¯•
        function runInitialTests() {
            console.log('ğŸ§ª è¿è¡Œåˆå§‹æµ‹è¯•å¥—ä»¶');
            
            addTestResult('åˆå§‹åŒ–æµ‹è¯•', 'å¼€å§‹è¿è¡Œåˆå§‹æµ‹è¯•å¥—ä»¶', 'info');
            
            // æµ‹è¯•è°ƒè¯•ç³»ç»Ÿæ˜¯å¦æ­£ç¡®åˆå§‹åŒ–
            testDebugSystemInitialization();
            
            // æµ‹è¯•ä¾èµ–æ£€æŸ¥
            setTimeout(() => testDependencyCheck(), 500);
            
            // æµ‹è¯•åŠŸèƒ½æµ‹è¯•
            setTimeout(() => testFunctionalTests(), 1000);
        }
        
        // æµ‹è¯•è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–
        function testDebugSystemInitialization() {
            console.log('ğŸ”§ æµ‹è¯•è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–');
            
            try {
                const tests = [
                    {
                        name: 'DebugMonitoringSystemç±»å­˜åœ¨',
                        test: () => typeof DebugMonitoringSystem !== 'undefined'
                    },
                    {
                        name: 'è°ƒè¯•ç›‘æ§å®ä¾‹å­˜åœ¨',
                        test: () => typeof debugMonitor !== 'undefined' && debugMonitor !== null
                    },
                    {
                        name: 'è°ƒè¯•å·¥å…·å¯ç”¨',
                        test: () => typeof debugTools !== 'undefined'
                    },
                    {
                        name: 'æ—¥å¿—è®°å½•å‡½æ•°å¯ç”¨',
                        test: () => typeof logInitializationProgress === 'function'
                    },
                    {
                        name: 'å…¨å±€é”™è¯¯å¤„ç†å·²è®¾ç½®',
                        test: () => debugMonitor && debugMonitor.state.initialized
                    }
                ];
                
                let passed = 0;
                const results = tests.map(test => {
                    const result = test.test();
                    if (result) passed++;
                    return { name: test.name, passed: result };
                });
                
                const success = passed === tests.length;
                addTestResult(
                    'è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–æµ‹è¯•',
                    `${passed}/${tests.length} é¡¹æµ‹è¯•é€šè¿‡`,
                    success ? 'success' : 'error'
                );
                
                // æ˜¾ç¤ºè¯¦ç»†ç»“æœ
                results.forEach(result => {
                    addToConsole(
                        result.passed ? 'SUCCESS' : 'ERROR',
                        `${result.name}: ${result.passed ? 'é€šè¿‡' : 'å¤±è´¥'}`
                    );
                });
                
            } catch (error) {
                addTestResult('è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–æµ‹è¯•', 'æµ‹è¯•æ‰§è¡Œå¼‚å¸¸: ' + error.message, 'error');
                console.error('è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–æµ‹è¯•å¼‚å¸¸:', error);
            }
        }
        
        // æµ‹è¯•ä¾èµ–æ£€æŸ¥
        function testDependencyCheck() {
            console.log('ğŸ” æµ‹è¯•ä¾èµ–æ£€æŸ¥åŠŸèƒ½');
            
            try {
                if (typeof debugTools === 'undefined') {
                    addTestResult('ä¾èµ–æ£€æŸ¥æµ‹è¯•', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨', 'error');
                    return;
                }
                
                const deps = debugTools.checkDependencies();
                const summary = deps.summary;
                
                addTestResult(
                    'ä¾èµ–æ£€æŸ¥æµ‹è¯•',
                    `æ€»è®¡: ${summary.total}, å¯ç”¨: ${summary.available}, ç¼ºå¤±: ${summary.missing}`,
                    summary.missing === 0 ? 'success' : 'warning'
                );
                
                // æ˜¾ç¤ºåˆ†ç±»ç»Ÿè®¡
                Object.entries(summary.byCategory).forEach(([category, stats]) => {
                    addToConsole(
                        'INFO',
                        `${category}ç±»åˆ«: ${stats.available}/${stats.total} å¯ç”¨`
                    );
                });
                
            } catch (error) {
                addTestResult('ä¾èµ–æ£€æŸ¥æµ‹è¯•', 'æµ‹è¯•æ‰§è¡Œå¼‚å¸¸: ' + error.message, 'error');
                console.error('ä¾èµ–æ£€æŸ¥æµ‹è¯•å¼‚å¸¸:', error);
            }
        }
        
        // æµ‹è¯•åŠŸèƒ½æµ‹è¯•
        function testFunctionalTests() {
            console.log('ğŸ§ª æµ‹è¯•åŠŸèƒ½æµ‹è¯•å¥—ä»¶');
            
            try {
                if (typeof debugTools === 'undefined') {
                    addTestResult('åŠŸèƒ½æµ‹è¯•', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨', 'error');
                    return;
                }
                
                const testResults = debugTools.runFunctionalTests();
                const summary = testResults.summary;
                
                addTestResult(
                    'åŠŸèƒ½æµ‹è¯•',
                    `é€šè¿‡ç‡: ${summary.passRate} (${summary.passed}/${summary.total})`,
                    summary.failed === 0 ? 'success' : 'warning'
                );
                
                // æ˜¾ç¤ºè¯¦ç»†ç»“æœ
                testResults.results.forEach(result => {
                    addToConsole(
                        result.passed ? 'SUCCESS' : 'ERROR',
                        `${result.name}: ${result.passed ? 'é€šè¿‡' : 'å¤±è´¥'} - ${result.message}`
                    );
                });
                
            } catch (error) {
                addTestResult('åŠŸèƒ½æµ‹è¯•', 'æµ‹è¯•æ‰§è¡Œå¼‚å¸¸: ' + error.message, 'error');
                console.error('åŠŸèƒ½æµ‹è¯•å¼‚å¸¸:', error);
            }
        }
        
        // æµ‹è¯•é”™è¯¯å¤„ç†
        function testErrorHandling() {
            console.log('âš ï¸ æµ‹è¯•é”™è¯¯å¤„ç†æœºåˆ¶');
            
            try {
                // æ¨¡æ‹ŸJavaScripté”™è¯¯
                setTimeout(() => {
                    throw new Error('è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é”™è¯¯');
                }, 100);
                
                // æ¨¡æ‹ŸPromiseæ‹’ç»
                setTimeout(() => {
                    Promise.reject(new Error('è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•Promiseæ‹’ç»'));
                }, 200);
                
                addTestResult('é”™è¯¯å¤„ç†æµ‹è¯•', 'å·²è§¦å‘æµ‹è¯•é”™è¯¯ï¼Œæ£€æŸ¥æ§åˆ¶å°è¾“å‡º', 'info');
                
            } catch (error) {
                addTestResult('é”™è¯¯å¤„ç†æµ‹è¯•', 'æµ‹è¯•æ‰§è¡Œå¼‚å¸¸: ' + error.message, 'error');
            }
        }
        
        // æµ‹è¯•æ€§èƒ½ç›‘æ§
        function testPerformanceMonitoring() {
            console.log('âš¡ æµ‹è¯•æ€§èƒ½ç›‘æ§åŠŸèƒ½');
            
            try {
                if (typeof debugTools === 'undefined') {
                    addTestResult('æ€§èƒ½ç›‘æ§æµ‹è¯•', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨', 'error');
                    return;
                }
                
                const report = debugTools.performanceReport();
                
                addTestResult(
                    'æ€§èƒ½ç›‘æ§æµ‹è¯•',
                    'æ€§èƒ½æŠ¥å‘Šå·²ç”Ÿæˆï¼Œæ£€æŸ¥æ§åˆ¶å°è¾“å‡º',
                    'success'
                );
                
                addToConsole('INFO', 'æ€§èƒ½ç›‘æ§æµ‹è¯•å®Œæˆï¼ŒæŠ¥å‘Šå·²ç”Ÿæˆ');
                
            } catch (error) {
                addTestResult('æ€§èƒ½ç›‘æ§æµ‹è¯•', 'æµ‹è¯•æ‰§è¡Œå¼‚å¸¸: ' + error.message, 'error');
                console.error('æ€§èƒ½ç›‘æ§æµ‹è¯•å¼‚å¸¸:', error);
            }
        }
        
        // æµ‹è¯•æ—¥å¿—å¯¼å‡º
        function testLogExport() {
            console.log('ğŸ“ æµ‹è¯•æ—¥å¿—å¯¼å‡ºåŠŸèƒ½');
            
            try {
                if (typeof debugTools === 'undefined') {
                    addTestResult('æ—¥å¿—å¯¼å‡ºæµ‹è¯•', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨', 'error');
                    return;
                }
                
                const exportData = debugTools.exportLogs();
                
                addTestResult(
                    'æ—¥å¿—å¯¼å‡ºæµ‹è¯•',
                    'æ—¥å¿—å¯¼å‡ºåŠŸèƒ½æ­£å¸¸ï¼Œæ–‡ä»¶å·²ä¸‹è½½',
                    'success'
                );
                
                addToConsole('SUCCESS', 'æ—¥å¿—å¯¼å‡ºæµ‹è¯•å®Œæˆ');
                
            } catch (error) {
                addTestResult('æ—¥å¿—å¯¼å‡ºæµ‹è¯•', 'æµ‹è¯•æ‰§è¡Œå¼‚å¸¸: ' + error.message, 'error');
                console.error('æ—¥å¿—å¯¼å‡ºæµ‹è¯•å¼‚å¸¸:', error);
            }
        }
        
        // æ‰§è¡Œå¥åº·æ£€æŸ¥
        function testHealthCheck() {
            console.log('ğŸ¥ æ‰§è¡Œå¥åº·æ£€æŸ¥');
            
            try {
                if (typeof debugTools === 'undefined') {
                    addTestResult('å¥åº·æ£€æŸ¥', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨', 'error');
                    return;
                }
                
                const healthResult = debugTools.healthCheck();
                
                addTestResult(
                    'å¥åº·æ£€æŸ¥',
                    `ç³»ç»ŸçŠ¶æ€: ${healthResult.overall ? 'å¥åº·' : 'å¼‚å¸¸'}`,
                    healthResult.overall ? 'success' : 'warning'
                );
                
                healthResult.results.forEach(result => {
                    addToConsole(
                        result.passed ? 'SUCCESS' : 'WARNING',
                        `${result.name}: ${result.passed ? 'æ­£å¸¸' : 'å¼‚å¸¸'}`
                    );
                });
                
            } catch (error) {
                addTestResult('å¥åº·æ£€æŸ¥', 'æ£€æŸ¥æ‰§è¡Œå¼‚å¸¸: ' + error.message, 'error');
                console.error('å¥åº·æ£€æŸ¥å¼‚å¸¸:', error);
            }
        }
        
        // æ¨¡æ‹Ÿé”™è¯¯
        function simulateError() {
            console.log('ğŸ’¥ æ¨¡æ‹Ÿç³»ç»Ÿé”™è¯¯');
            
            // æ¨¡æ‹Ÿä¸åŒç±»å‹çš„é”™è¯¯
            const errorTypes = [
                () => { throw new Error('æ¨¡æ‹ŸJavaScriptè¿è¡Œæ—¶é”™è¯¯'); },
                () => { Promise.reject(new Error('æ¨¡æ‹ŸPromiseæ‹’ç»é”™è¯¯')); },
                () => { 
                    const img = document.createElement('img');
                    img.src = 'nonexistent-image.jpg';
                    document.body.appendChild(img);
                }
            ];
            
            const randomError = errorTypes[Math.floor(Math.random() * errorTypes.length)];
            
            try {
                randomError();
                addTestResult('é”™è¯¯æ¨¡æ‹Ÿ', 'å·²è§¦å‘æ¨¡æ‹Ÿé”™è¯¯', 'info');
            } catch (error) {
                addTestResult('é”™è¯¯æ¨¡æ‹Ÿ', 'é”™è¯¯å·²è§¦å‘: ' + error.message, 'warning');
            }
        }
        
        // æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€
        function showSystemStatus() {
            if (typeof debugTools !== 'undefined') {
                const status = debugTools.getSystemStatus();
                addToConsole('INFO', 'ç³»ç»ŸçŠ¶æ€æŠ¥å‘Šå·²ç”Ÿæˆï¼Œæ£€æŸ¥æ§åˆ¶å°');
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // æ˜¾ç¤ºä¾èµ–æŠ¥å‘Š
        function showDependencyReport() {
            if (typeof debugTools !== 'undefined') {
                const deps = debugTools.checkDependencies();
                addToConsole('INFO', 'ä¾èµ–çŠ¶æ€æŠ¥å‘Šå·²ç”Ÿæˆï¼Œæ£€æŸ¥æ§åˆ¶å°');
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // æ˜¾ç¤ºé”™è¯¯æŠ¥å‘Š
        function showErrorReport() {
            if (typeof debugTools !== 'undefined') {
                const report = debugTools.errorReport();
                addToConsole('INFO', 'é”™è¯¯æŠ¥å‘Šå·²ç”Ÿæˆï¼Œæ£€æŸ¥æ§åˆ¶å°');
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // æ˜¾ç¤ºæ€§èƒ½æŠ¥å‘Š
        function showPerformanceReport() {
            if (typeof debugTools !== 'undefined') {
                const report = debugTools.performanceReport();
                addToConsole('INFO', 'æ€§èƒ½æŠ¥å‘Šå·²ç”Ÿæˆï¼Œæ£€æŸ¥æ§åˆ¶å°');
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // æµ‹é‡é¡µé¢æ€§èƒ½æŒ‡æ ‡
        function measurePageMetrics() {
            if ('performance' in window) {
                const navigation = performance.getEntriesByType('navigation')[0];
                const metrics = {
                    'DNSæŸ¥è¯¢': (navigation.domainLookupEnd - navigation.domainLookupStart).toFixed(2) + 'ms',
                    'TCPè¿æ¥': (navigation.connectEnd - navigation.connectStart).toFixed(2) + 'ms',
                    'é¡µé¢åŠ è½½': (navigation.loadEventEnd - navigation.navigationStart).toFixed(2) + 'ms'
                };
                
                Object.entries(metrics).forEach(([key, value]) => {
                    addToConsole('INFO', `${key}: ${value}`);
                });
            } else {
                addToConsole('WARNING', 'Performance API ä¸æ”¯æŒ');
            }
        }
        
        // ä¼˜åŒ–æ€§èƒ½
        function optimizePerformance() {
            if (typeof debugTools !== 'undefined') {
                // æ¸…ç†è°ƒè¯•ç¼“å­˜
                debugTools.clearCache();
                addToConsole('SUCCESS', 'æ€§èƒ½ä¼˜åŒ–å®Œæˆ');
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // æ¸…ç†è°ƒè¯•ç¼“å­˜
        function clearDebugCache() {
            if (typeof debugTools !== 'undefined') {
                debugTools.clearCache();
                addToConsole('SUCCESS', 'è°ƒè¯•ç¼“å­˜å·²æ¸…ç†');
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // é‡ç½®è°ƒè¯•çŠ¶æ€
        function resetDebugState() {
            if (typeof debugTools !== 'undefined') {
                debugTools.reset();
                addToConsole('SUCCESS', 'è°ƒè¯•çŠ¶æ€å·²é‡ç½®');
                updateSystemStatus();
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // å¯¼å‡ºæ‰€æœ‰æ—¥å¿—
        function exportAllLogs() {
            if (typeof debugTools !== 'undefined') {
                debugTools.exportLogs();
                addToConsole('SUCCESS', 'æ‰€æœ‰æ—¥å¿—å·²å¯¼å‡º');
            } else {
                addToConsole('ERROR', 'è°ƒè¯•å·¥å…·ä¸å¯ç”¨');
            }
        }
        
        // æ·»åŠ æµ‹è¯•ç»“æœ
        function addTestResult(testName, message, type) {
            const result = {
                name: testName,
                message: message,
                type: type,
                timestamp: new Date().toISOString()
            };
            
            testResults.push(result);
            
            const resultsContainer = document.getElementById('test-results');
            const resultElement = document.createElement('div');
            resultElement.className = `test-result ${type}`;
            resultElement.innerHTML = `
                <strong>${testName}</strong>: ${message}
                <small class="float-end">${new Date().toLocaleTimeString()}</small>
            `;
            
            resultsContainer.appendChild(resultElement);
            resultsContainer.scrollTop = resultsContainer.scrollHeight;
        }
        
        // æ·»åŠ åˆ°æ§åˆ¶å°è¾“å‡º
        function addToConsole(level, message) {
            const consoleOutput = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${level}: ${message}\n`;
            
            consoleOutput.textContent += logEntry;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            if (level === 'ERROR') {
                errorCount++;
                updateErrorCount();
            }
        }
        
        // æ¸…ç©ºæ§åˆ¶å°è¾“å‡º
        function clearConsoleOutput() {
            document.getElementById('console-output').textContent = '';
            addToConsole('INFO', 'æ§åˆ¶å°è¾“å‡ºå·²æ¸…ç©º');
        }
        
        // å¯¼å‡ºæ§åˆ¶å°è¾“å‡º
        function exportConsoleOutput() {
            const output = document.getElementById('console-output').textContent;
            const blob = new Blob([output], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `console-output-${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.txt`;
            link.click();
            
            addToConsole('SUCCESS', 'æ§åˆ¶å°è¾“å‡ºå·²å¯¼å‡º');
        }
        
        // å®šæœŸæ›´æ–°ç³»ç»ŸçŠ¶æ€
        setInterval(updateSystemStatus, 5000);
    </script>
</body>
</html>